# 《攻城掠地》桌游项目 - 自动备份Cron配置
# 将此文件内容添加到 /etc/crontab 或使用 crontab -e 编辑

# 环境变量
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
SHELL=/bin/bash
MAILTO=admin@yourdomain.com

# 每日凌晨2点执行完整备份
0 2 * * * root /var/www/siege-game/deployment/backup.sh full >> /var/log/siege-game/backup/cron-backup.log 2>&1

# 每6小时执行应用代码备份
0 */6 * * * root /var/www/siege-game/deployment/backup.sh app >> /var/log/siege-game/backup/cron-backup.log 2>&1

# 每小时执行配置文件备份
0 * * * * root /var/www/siege-game/deployment/backup.sh config >> /var/log/siege-game/backup/cron-backup.log 2>&1

# 每周日凌晨1点执行数据库备份
0 1 * * 0 root /var/www/siege-game/deployment/backup.sh database >> /var/log/siege-game/backup/cron-backup.log 2>&1

# 每天凌晨3点执行健康检查
0 3 * * * root /var/www/siege-game/deployment/health-check.sh full >> /var/log/siege-game/health-check.log 2>&1

# 每小时执行快速健康检查
0 * * * * root /var/www/siege-game/deployment/health-check.sh quick >> /var/log/siege-game/health-check.log 2>&1

# 每天凌晨4点清理旧日志
0 4 * * * root /usr/sbin/logrotate -f /var/www/siege-game/deployment/logging/logrotate.conf

# 每周一凌晨5点执行系统更新检查
0 5 * * 1 root apt update && apt list --upgradable >> /var/log/siege-game/system-updates.log 2>&1

# 每月1号凌晨6点执行磁盘清理
0 6 1 * * root find /var/log -name "*.log" -mtime +30 -delete && find /tmp -mtime +7 -delete

# SSL证书续期检查 (每天凌晨5点)
0 5 * * * root /usr/bin/certbot renew --quiet --post-hook "systemctl reload nginx"

# 监控脚本 (每5分钟)
*/5 * * * * root /var/www/siege-game/deployment/monitoring-check.sh >> /var/log/siege-game/monitoring.log 2>&1

# Docker清理 (每周日凌晨6点)
0 6 * * 0 root docker system prune -f >> /var/log/siege-game/docker-cleanup.log 2>&1